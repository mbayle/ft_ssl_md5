#include "ft_ssl.h"
#include "ft_md5.h"

#include <math.h>
static double	ft_pow(double n, t_uint32 pow)
{
	double	result;

	result = n;
	while (--pow)
		result = result * n;
	return (result);
}

t_uint32	*calctable_init(void)
{
	double	s[64];
	double	pwr;
	int		i;
	t_uint32	*k;

	s[0] = 0.84147098480789650;
	s[1] = 0.90929742682568171;
	s[2] = 0.14112000805986721;
	s[3] = 0.75680249530792820;
	s[4] = 0.95892427466313845;
	s[5] = 0.27941549819892586;
	s[6] = 0.65698659871878906;
	s[7] = 0.98935824662338179;
	s[8] = 0.41211848524175659;
	s[9] = 0.54402111088936977;
	s[10] = 0.99999020655070348;
	s[11] = 0.53657291800043494;
	s[12] = 0.42016703682664092;
	s[13] = 0.99060735569487035;
	s[14] = 0.65028784015711683;
	s[15] = 0.28790331666506530;
	s[16] = 0.96139749187955681;
	s[17] = 0.75098724677167605;
	s[18] = 0.14987720966295234;
	s[19] = 0.91294525072762767;
	s[20] = 0.83665563853605607;
	s[21] = 0.00885130929040388;
	s[22] = 0.84622040417517064;
	s[23] = 0.90557836200662389;
	s[24] = 0.13235175009777303;
	s[25] = 0.76255845047960269;
	s[26] = 0.95637592840450303;
	s[27] = 0.27090578830786904;
	s[28] = 0.66363388421296754;
	s[29] = 0.98803162409286183;
	s[30] = 0.40403764532306502;
	s[31] = 0.55142668124169059;
	s[32] = 0.99991186010726718;
	s[33] = 0.52908268612002385;
	s[34] = 0.42818266949615102;
	s[35] = 0.99177885344311578;
	s[36] = 0.64353813335699950;
	s[37] = 0.29636857870938532;
	s[38] = 0.96379538628408779;
	s[39] = 0.74511316047934883;
	s[40] = 0.15862266880470899;
	s[41] = 0.91652154791563378;
	s[42] = 0.83177474262859830;
	s[43] = 0.01770192510541358;
	s[44] = 0.85090352453411844;
	s[45] = 0.90178834764880922;
	s[46] = 0.12357312274522400;
	s[47] = 0.76825466132366682;
	s[48] = 0.95375265275947185;
	s[49] = 0.26237485370392877;
	s[50] = 0.67022917584337471;
	s[51] = 0.98662759204048534;
	s[52] = 0.39592515018183416;
	s[53] = 0.55878904885161629;
	s[54] = 0.99975517335861985;
	s[55] = 0.52155100208691185;
	s[56] = 0.43616475524782494;
	s[57] = 0.99287264808453712;
	s[58] = 0.63673800713913786;
	s[59] = 0.30481062110221668;
	s[60] = 0.96611777000839294;
	s[61] = 0.73918069664922281;
	s[62] = 0.16735570030280691;
	s[63] = 0.92002603819679063;
	i = 0;
	k = malloc(sizeof(t_uint32) * 64);
	pwr = ft_pow(2.0, 32);
	while (i < 64)
	{
		//s = fabs(sin(1.0 + i));
		k[i] = (t_uint32)(s[i] * pwr);
		i++;
	}
	return (k);
}

t_uint32	*context_init(void)
{
	t_uint32	*states;

	states = malloc(sizeof(t_uint32) * 4);
	states[0] = 0x67452301;
	states[1] = 0xEFCDAB89;
	states[2] = 0x98BADCFE;
	states[3] = 0x10325476;
	return (states);
}
